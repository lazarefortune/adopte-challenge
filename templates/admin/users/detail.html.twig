{% extends 'base.html.twig' %}

{% block body %}
    <div class="min-h-screen">
       <div class="max-w-6xl mx-auto flex flex-col gap-5 justify-center">
            <div>
                <a href="{{ path('admin_users') }}" class="btn-secondary">Retour vers la liste des utilisateurs</a>
            </div>
           <div class="">

               <h1 class="text-3xl font-semibold mb-6">
                   Détails utilisateur : {{ user.name }}
               </h1>

               <div class="card mb-6">
                   <div class="card-header">Informations utilisateur</div>
                   <div class="card-body">
                       <p><strong>ID :</strong> {{ user.id }}</p>
                       <p><strong>Email :</strong> {{ user.email }}</p>
                       <p><strong>Remote ID :</strong> {{ user.remotePaymentId ?? '—' }}</p>
                       <p><strong>Abonnements :</strong> {{ user.subscriptionsCount }}</p>
                       <p><strong>Achats :</strong> {{ user.purchasesCount }}</p>
                   </div>
               </div>

               <div class="card mb-6">
                   <div class="card-header">Abonnements</div>
                   <div class="card-body">
                       {% for s in subscriptions %}
                           <div class="border-b py-3">
                               <p><strong>Type :</strong> {{ s.typeName }}</p>
                               <p><strong>Prix :</strong> {{ s.typePrice }} €</p>
                               <p><strong>Début :</strong> {{ s.startDate|date('d/m/Y') }}</p>
                               <p><strong>Prochain paiement :</strong> {{ s.nextPaymentDate|date('d/m/Y') }}</p>
                               <p><strong>Fin engagement :</strong> {{ s.commitmentEndDate|date('d/m/Y') }}</p>
                               <p><strong>Actif :</strong> {{ s.isActive ? 'Oui' : 'Non' }}</p>
                           </div>
                       {% else %}
                           <p class="text-gray-500">Aucun abonnement trouvé.</p>
                       {% endfor %}
                   </div>
               </div>

               <div class="card">
                   <div class="card-header">Achats</div>
                   <div class="card-body">
                       {% for p in purchases %}
                           <div class="border-b py-3">
                               <p><strong>Montant :</strong> {{ p.amount }} €</p>
                               <p><strong>Transaction :</strong> {{ p.transactionId }}</p>
                               <p><strong>Abonnement :</strong> {{ p.subscriptionName ?? '—' }}</p>
                               <p><strong>Date :</strong> {{ p.createdAt|date('d/m/Y H:i') }}</p>
                           </div>
                       {% else %}
                           <p class="text-gray-500">Aucun achat trouvé.</p>
                       {% endfor %}
                   </div>
               </div>

           </div>
       </div>
    </div>
{% endblock %}
